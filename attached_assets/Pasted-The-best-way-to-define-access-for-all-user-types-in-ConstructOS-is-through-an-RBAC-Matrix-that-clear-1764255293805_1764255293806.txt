The best way to define access for all user types in ConstructOS is through an RBAC Matrix that clearly maps defined Roles to Actions (Permissions) across all Microservices (Resources), adhering to the principle of least privilege.Since Melach Construction operates in a construction/ERP environment, we need to expand the roles to include not only internal staff but also common external users like subcontractors and clients.üë• Comprehensive User Roles for ConstructOSWe define 11 core roles, categorized by their primary domain:Role CategoryUser Role (Entra ID Group/App Role)Primary ResponsibilityKey Access ConstraintI. ExecutiveSystem AdminFull system configuration and oversight.Full Access (Global)II. FinancialFinance ManagerAuditing, budget control, and payment processing.Global, Read/Write in FinanceIII. Sales/CRMSales RepresentativeManaging leads, opportunities, and client relationships.Limited to assigned Accounts/LeadsIV. OperationsOperations SpecialistProcurement, logistics, and inventory control.Global, Read/Write in Inventory/OrdersV. Site/FieldSite ManagerDaily project execution, labor, and safety compliance.Limited to assigned Site/Project IDVI. HR/SupportHR SpecialistEmployee records, benefits, and payroll entry.Global, Read/Write in HRVII. InventoryWarehouse ClerkReceiving goods, issuing stock, and cycle counts.Limited to assigned Warehouse LocationVIII. FieldField WorkerClocking in/out, viewing assigned tasks/safety protocols.Limited to own timecard/tasksIX. ExternalSubcontractor/VendorManaging assigned Purchase Orders and submitting invoices.Limited to own PO/Invoice documentsX. ExternalClient/Customer PortalViewing project progress and approving quotes/change orders.Limited to own Project/Account dataXI. ExecutiveExecutive Viewer (C-Suite)High-level data analysis and reporting.Global, Read-Only on all business reportsüõ°Ô∏è Role-Based Access Control (RBAC) MatrixThis matrix details the minimum required access level for each role across your key microservices. This is enforced using the Django REST Framework (DRF) Permission Classes and queryset filtering.Resource (Microservice)System AdminFinance ManagerSales RepOperations SpecialistSite ManagerWarehouse ClerkSubcontractorClient/CustomerFinance/AccountingRWDARWDARead (Quote Value)Read (Invoices/Bills)Read (Project Budget)NoneCreate (Invoice Bill)Read (Own Invoices)Order/ProjectRWDARead/ApproveRWDA (Quote/Opp)RWDA (PO/Status)RW (Site-Specific)Read (PO Status)Read (Own PO)Read (Own Project)Inventory/LogisticsRWDARead (Cost/Value)Read (Stock Check)RWDA (All Items)R/W (Site Stock Only)R/W (Own Warehouse)NoneNoneHR/PayrollRWDAR (Payroll Figures)NoneNoneR (Site Team Only)NoneNoneNoneCompliance/SafetyRWDAR (Audit Trails)NoneR (Global Status)R/W (Site-Specific)NoneNoneNoneContact/CRMRWDAR/W (Billing Info)RWDA (Own Accounts)R (Vendor List)R (Site Contacts)R (Vendors)R (Own Profile)R (Own Profile)Legend:AbbreviationAccess LevelDescription (Django Enforcement)RWDARead, Write, Delete, ApproveFull access (IsAdminUser or custom class).R/WRead and Write/EditCan create and update records.RRead OnlyCan view records.CreateCreate OnlyCan only post new records (e.g., Subcontractor Invoice).NoneAccess Denied (403 Forbidden)Blocked by DRF permission class.üîé Detailed Access ConstraintsThe key to stability and security lies in the constraints applied at the DRF view level, which go beyond simple Read/Write.1. Site Manager (SIT-JHB001) and Warehouse Clerk (WHS-CPT002)Constraint: Geographic Filtering is applied to the queryset.Implementation: The DRF view's get_queryset() method fetches the user's site_id from the Auth Token and returns only:PythonOrder.objects.filter(site_id=user.profile.site_id)
2. Finance Manager and Operations SpecialistConstraint: Segregation of Duties (SoD) is enforced.Implementation: They both have Read access to Orders, but only the Operations Specialist has Write/Edit access to the order_fulfillment_status field, and only the Finance Manager has Write/Edit access to the invoice_payment_status field. This is controlled by overriding the DRF serializer's update() method or using custom field-level permissions.3. Subcontractor/VendorConstraint: Record Ownership is strictly enforced.Implementation: The Subcontractor can only view Purchase Orders where their vendor_id matches the vendor_id on the PO. They can only Create an invoice, but cannot Edit or Delete it after it has been submitted to the Finance Service (unless Finance sends it back for revision).